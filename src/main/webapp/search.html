<!DOCTYPE html>
<html>
<head>
<title>Merchant Feed</title>
<link rel="stylesheet" href="/css/main.css">
<link rel="stylesheet" href="/css/user-page.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
<script src="/js/navigation-loader.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
<nav>
<ul id="navigation">
    <li><a href="/index.html">Home</a></li>
    <li><a href="/aboutus.html">About Our Team</a></li>
    <li><a href="/">Search Merchant</a></li>
</ul>
</nav>
<script>
    
  // Fetch messages and add them to the page.
  function fetchMerchants(){
    const url = '/merchants';
    fetch(url).then((response) => {
      return response.json();
    }).then((merchants) => {
      const merchantContainer = document.getElementById('message-container');
      if(merchants.length == 0){
        merchantContainer.innerHTML = '<p>There are no posts yet.</p>';
      }
      else{
        merchantContainer.innerHTML = '';  
      }
      merchants.forEach((merchant) => {  
       const merchantDiv = buildMerchantDiv(merchant);
       merchantContainer.appendChild(merchantDiv);
      });
    });
  }
  
  function buildMerchantDiv(merchant){
   const nameDiv = document.createElement('div');
   nameDiv.classList.add("left-align");
   nameDiv.appendChild(document.createTextNode(merchant.name));
   
//    const timeDiv = document.createElement('div');
//    timeDiv.classList.add('right-align');
//    timeDiv.appendChild(document.createTextNode(new Date(message.timestamp)));
   
   const headerDiv = document.createElement('div');
   headerDiv.classList.add('message-header');
   headerDiv.appendChild(nameDiv);
//    headerDiv.appendChild(timeDiv);
   
   const bodyDiv = document.createElement('div');
   bodyDiv.classList.add('message-body');
   bodyDiv.appendChild(document.createTextNode(merchant.distance));
   bodyDiv.appendChild(document.createTextNode(merchant.cuisine));
   bodyDiv.appendChild(document.createTextNode(merchant.priceRange));
   
   const merchantDiv = document.createElement('div');
   merchantDiv.classList.add("message-div");
   merchantDiv.appendChild(headerDiv);
   merchantDiv.appendChild(bodyDiv);
   
   return merchantDiv;
  }
  
  // Fetch data and populate the UI of the page.
  function buildUI(){
   fetchMerchants();
  }
</script>
</head>
<body onload="buildUI()">
 <div id="content">
  <h1>Merchant Feed</h1>
  <hr/>
  <div id="message-container">Loading...</div>
 </div>
</body>
</html>